name: Ancestry
version: $SERVICE_TAG
description: This service analyzes the genealogy of a file
accepts: .*
rejects: empty|metadata/.*

stage: REVIEW
category: Static Analysis

file_required: false
timeout: 300
disable_cache: true

enabled: true
is_external: false
licence_count: 0
uses_tags: false
uses_tag_scores: false
uses_metadata: false
uses_temp_submission_data: true

config:
  signatures:
    exe_from_office_document:
      pattern: "document/office/.+,ROOT\\|executable/windows/(?:pe|dll)(?:32|64),EXTRACTED"
      score: 1000

heuristics:
  - name: "Legacy Signature Hit"
    heur_id: 1
    score: 0 # Score dictated by signatures
    description: "Signature Hit on Genealogy"
    filetype: "*"

docker_config:
  image: ${PRIVATE_REGISTRY}cccs/assemblyline-service-ancestry:$SERVICE_TAG
  cpu_cores: 1
  ram_mb: 512
